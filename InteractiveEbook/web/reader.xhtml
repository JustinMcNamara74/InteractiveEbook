<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html">
    <h:head>
        <title>WheeReader - 4J Interactive</title>
    </h:head>
    <h:body style="padding-top: 60px;">
        <ui:insert name="header" >
            <ui:include src="/template/navbar.xhtml" />
	</ui:insert>
        
        <table width="100%">
            <tr>
                <td width="25%">
                    <div id="chapterFrame" align="left" style="overflow: auto;">
                        <b:panel look="primary">
                            <f:facet name="heading">Chapters</f:facet>   
                            <b:listLinks>
                                <ui:repeat value="#{readerBean.chapterList}" var="chapter">
                                    <b:navLink href="?chapter=#{chapter.number}" value="#{chapter.number} - #{chapter.title}" rendered="#{!(param['chapter'] == chapter.number)}"/>
                                    
                                    <b:panel rendered="#{(param['chapter'] == chapter.number)}">
                                        <b:navLink></b:navLink>
                                        <b:navLink header="#{chapter.number} - #{chapter.title}"/>
                                        <ui:repeat value="#{chapter.subsections}" var="subsection">
                                            <li>
                                                <a href="#" onclick="goToSubsection('#{chapter.sourceUrl}##{chapter.number}-#{subsection.number}');">#{chapter.number}.#{subsection.number} - #{subsection.title}</a>
                                            </li>
                                        </ui:repeat>
                                        <b:navLink></b:navLink>
                                    </b:panel>
                                </ui:repeat>

                            </b:listLinks>
                         </b:panel>
                    </div>
                </td>
                
                <td width="75%" align="center">
                    <h:panelGroup rendered="#{userBean.loggedIn}">
                        <h:panelGroup rendered="#{(param['chapter'] == 5)}" style="height: 100%;">
                            
                                <iframe id="textFrame" name="chapterTextFrame" src="chapters/Chapter5.html" width="100%" height="100%"></iframe>
                        </h:panelGroup>
                    </h:panelGroup>
                    
                    <h:panelGroup rendered="#{(param['chapter'] != null and !userBean.loggedIn)}">
                        <h2>You must <a href="register.xhtml">register</a> or <a href="login.xhtml">login</a> before you can access this chapter.</h2>
                    </h:panelGroup>
                    
                    <h:panelGroup rendered="#{param['chapter'] == null}">
                        <img src="images/intro10eComprehensive.jpg" align="center"/>
                    </h:panelGroup>
                </td>
            </tr>
        </table>
    </h:body>
    <script language="javascript">
        
        var goToSubsection=function(subsectionUrl) {
            $("#textFrame").attr("src", subsectionUrl);
        };
        
        var resizeFrames = function() {
            $("#chapterFrame").height($(window).height() - 60);
            
            $("#textFrame").position({ left: ($("#chapterFrame").width()+10), top: 60});
        };
        
        $(window).load(function() {
            resizeFrames();
            
            $(".subSectionLink").attr("target","chapterTextFrame");
        });
        
        $( window ).resize(function() {
            resizeFrames();
          });
    </script>
</html>

